{% extends "layout.html" %}
{% block content %}
<div class="container-fluid doctor-dashboard">
    <!-- Accueil et statistiques rapides -->
    <div class="row mb-3">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h2 class="text-primary mb-1">Bienvenue, Dr. {{ current_user.username }}</h2>
                    <p class="text-muted mb-0" id="current-date"></p>
                </div>
                <div class="text-end">
                    <span class="badge bg-primary fs-6 px-3 py-2">
                        <i class="fas fa-clock me-1"></i>
                        <span id="current-time"></span>
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistiques du jour -->
    <div class="row mb-3 dashboard-stats-row">
        <div class="col-xl-2 col-lg-3 col-md-4 col-6 mb-2">
            <div class="card dashboard-card card-consultations text-white">
                <div class="card-body">
                    <div>
                        <h6 class="card-title">Consultations du jour</h6>
                        <h2 class="mb-0">{{ daily_stats.visits_count or 0 }}</h2>
                    </div>
                    <i class="fas fa-user-md"></i>
                </div>
            </div>
        </div>
        
        <div class="col-xl-2 col-lg-3 col-md-4 col-6 mb-2">
            <div class="card dashboard-card card-revenue text-white">
                <div class="card-body">
                    <div>
                        <h6 class="card-title">Revenus du jour</h6>
                        <h2 class="mb-0">{{ daily_stats.revenue or 0 }} <small>DA</small></h2>
                    </div>
                    <i class="fas fa-money-bill-wave"></i>
                </div>
            </div>
        </div>
        
        <div class="col-xl-2 col-lg-3 col-md-4 col-6 mb-2">
            <div class="card dashboard-card card-waiting text-white">
                <div class="card-body">
                    <div>
                        <h6 class="card-title">En attente</h6>
                        <h2 class="mb-0">{{ waiting_tickets|length }}</h2>
                    </div>
                    <i class="fas fa-hourglass-half"></i>
                </div>
            </div>
        </div>
        
        <div class="col-xl-2 col-lg-3 col-md-4 col-6 mb-2">
            <div class="card dashboard-card card-new-patients text-white">
                <div class="card-body">
                    <div>
                        <h6 class="card-title">Nouveaux patients</h6>
                        <h2 class="mb-0">{{ daily_stats.new_patients or 0 }}</h2>
                    </div>
                    <i class="fas fa-user-plus"></i>
                </div>
            </div>
        </div>
        
        <div class="col-xl-2 col-lg-3 col-md-4 col-6 mb-2">
            <div class="card dashboard-card card-today-appointments text-white">
                <div class="card-body">
                    <div>
                        <h6 class="card-title">Rendez-vous du jour</h6>
                        <h2 class="mb-0">{{ daily_stats.today_appointments or 0 }}</h2>
                    </div>
                    <i class="fas fa-calendar-day"></i>
                </div>
            </div>
        </div>
        
        <div class="col-xl-2 col-lg-3 col-md-4 col-6 mb-2">
            <div class="card dashboard-card card-upcoming-appointments text-white">
                <div class="card-body">
                    <div>
                        <h6 class="card-title">Rendez-vous à venir</h6>
                        <h2 class="mb-0">{{ daily_stats.upcoming_appointments or 0 }}</h2>
                    </div>
                    <i class="fas fa-calendar-check"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- المريض الحالي -->
        <div class="col-lg-8 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="fas fa-stethoscope me-2"></i>Patient actuel
                    </h5>
                    {% if current_ticket %}
                        {% if current_ticket.priority == 1 %}
                            <span class="badge bg-warning text-dark">{{ current_ticket.display_number }} - priorité</span>
                        {% else %}
                            <span class="badge bg-light text-primary">Numéro {{ current_ticket.display_number }}</span>
                        {% endif %}
                    {% endif %}
                </div>
                <div class="card-body">
                    {% if current_ticket %}
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="avatar-circle bg-primary text-white me-3">
                                        {{ current_patient.full_name[0] }}
                                    </div>
                                    <div>
                                        <h4 class="mb-1">{{ current_patient.full_name }}</h4>
                                        <p class="text-muted mb-0">
                                            <i class="fas fa-phone me-1"></i>{{ current_patient.phone }}
                                        </p>
                                    </div>
                                </div>
                                <div class="row text-center">
                                    <div class="col-4">
                                        <small class="text-muted">l'âge</small>
                                        <div class="fw-bold">
                                            {% if current_patient.age %}
                                                {{ current_patient.age }} ans
                                            {% else %}
                                                indéfini
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <small class="text-muted">Le genre</small>
                                        <div class="fw-bold">
                                            {{ "male" if current_patient.gender == "male" else "female" if current_patient.gender == "female" else "indéfini" }}
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <small class="text-muted">Groupe sanguin</small>
                                        <div class="fw-bold">{{ current_patient.blood_group or "indéfini" }}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 text-center">
                                <a href="{{ url_for('doctor.patient_visit', patient_id=current_patient.id) }}" 
                                   class="btn btn-success btn-lg mb-2 w-100">
                                    <i class="fas fa-user-md me-2"></i>Commencer consultation
                                </a>
                                <a href="{{ url_for('doctor.patient_details', patient_id=current_patient.id) }}" 
                                   class="btn btn-outline-primary w-100">
                                    <i class="fas fa-history me-2"></i>dossier médical
                                </a>
                            </div>
                        </div>
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-user-clock fa-3x text-muted mb-3"></i>
                            <h5 class="text-muted">Il n'y a pas de patient actuel</h5>
                            <p class="text-muted">Vous pouvez appeler un patient depuis la liste d'attente.</p>
                            {% if waiting_tickets %}
                                <form method="POST" action="{{ url_for('doctor.call_next_patient') }}" class="d-inline">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-bullhorn me-2"></i>Appeler le prochain patient
                                    </button>
                                </form>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Liste d'attente -->
        <div class="col-lg-4 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-warning text-dark d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="fas fa-list me-2"></i>Liste d'attente
                    </h5>
                    <div>
                        <span class="badge bg-dark me-2">{{ waiting_tickets|length }}</span>
                        <a href="{{ url_for('doctor.waiting_queue_status') }}" class="btn btn-sm btn-outline-dark" title="Voir les détails">
                            <i class="fas fa-eye"></i>
                        </a>
                    </div>
                </div>
                <div class="card-body p-0">
                    {% if waiting_tickets %}
                        <div class="list-group list-group-flush" style="max-height: 400px; overflow-y: auto;">
                            {# n'afficher que les 2 prochains après l'actuel #}
                            {% for ticket in waiting_tickets[:2] %}
                                <div class="list-group-item d-flex justify-content-between align-items-center {% if ticket.priority == 1 %}priority-item-highlight emergency-item-dashboard{% elif ticket.priority == 2 %}critical-item-highlight{% endif %}">
                                    <div class="d-flex align-items-center">
                                        {% if ticket.priority == 2 %}
                                            <span class="badge bg-danger text-white rounded-pill me-2 critical-badge-pulse">
                                                <i class="fas fa-exclamation-circle me-1"></i>{{ ticket.display_number }}
                                            </span>
                                        {% elif ticket.priority == 1 %}
                                            <span class="badge bg-warning text-dark rounded-pill me-2 priority-badge-pulse">
                                                <i class="fas fa-star me-1"></i>{{ ticket.display_number }}
                                            </span>
                                        {% else %}
                                            <span class="badge bg-primary rounded-pill me-2">{{ ticket.display_number }}</span>
                                        {% endif %}
                                        <div>
                                            <div class="fw-bold">
                                                {{ ticket.patient.full_name }}
                                                {% if ticket.priority == 2 %}
                                                    <span class="badge bg-danger text-white ms-2 critical-badge-inline">
                                                        <i class="fas fa-exclamation-circle me-1"></i>CRITIQUE
                                                    </span>
                                                {% elif ticket.priority == 1 %}
                                                    <span class="badge bg-warning text-dark ms-2 urgent-badge-inline">
                                                        <i class="fas fa-star me-1"></i>PRIORITÉ
                                                    </span>
                                                {% endif %}
                                            </div>
                                            <small class="text-muted">
                                                <i class="fas fa-clock me-1"></i>Arrivé: {{ ticket.created_at.strftime('%H:%M') }}
                                                {% if ticket.appointment %}
                                                    <span class="text-info ms-2">
                                                        <i class="fas fa-calendar-check me-1"></i>RDV: {{ ticket.appointment.appointment_date.strftime('%H:%M') }}
                                                    </span>
                                                {% endif %}
                                            </small>
                                        </div>
                                    </div>
                                    {% if ticket.priority == 2 %}
                                        <div class="d-flex flex-column align-items-center critical-indicators">
                                            <i class="fas fa-exclamation-circle text-danger fa-2x mb-1 critical-icon" title="Patient critique"></i>
                                            <span class="badge bg-danger text-white px-2 py-1 small critical-badge-small">CRITIQUE</span>
                                            <div class="critical-pulse-dot mt-1"></div>
                                        </div>
                                    {% elif ticket.priority == 1 %}
                                        <div class="d-flex flex-column align-items-center priority-indicators">
                                            <i class="fas fa-star text-warning fa-lg mb-1 priority-icon" title="Patient prioritaire"></i>
                                            <span class="badge bg-warning text-dark px-2 py-1 small priority-badge-small">PRIORITÉ</span>
                                            <i class="fas fa-calendar-check text-info mt-1" title="Avec rendez-vous"></i>
                                        </div>
                                    {% else %}
                                        <i class="fas fa-clock text-muted"></i>
                                    {% endif %}
                                </div>
                            {% endfor %}
                            {% if waiting_tickets|length > 2 %}
                                <div class="list-group-item text-center text-muted">
                                    et {{ waiting_tickets|length - 2 }} autre(s) en attente...
                                </div>
                            {% endif %}
                        </div>
                        <div class="card-footer text-center">
                            <form method="POST" action="{{ url_for('doctor.call_next_patient') }}" class="d-inline">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fas fa-bullhorn me-2"></i>Appeler le suivant
                                </button>
                            </form>
                        </div>
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-check-circle fa-3x text-success mb-3"></i>
                            <h6 class="text-muted">Aucun patient en attente</h6>
                            <p class="text-muted small">Tous les patients ont été examinés</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Actions rapides -->
    <div class="row">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-bolt me-2"></i>Actions rapides
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <a href="{{ url_for('doctor.visit_history') }}" class="btn btn-outline-primary w-100 h-100 d-flex flex-column justify-content-center">
                                <i class="fas fa-history fa-2x mb-2"></i>
                                <span>Historique des consultations</span>
                            </a>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <a href="{{ url_for('doctor.appointments') }}" class="btn btn-outline-warning w-100 h-100 d-flex flex-column justify-content-center">
                                <i class="fas fa-calendar-check fa-2x mb-2"></i>
                                <span>Rendez-vous</span>
                            </a>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <a href="{{ url_for('doctor.doctor_payments') }}" class="btn btn-outline-success w-100 h-100 d-flex flex-column justify-content-center">
                                <i class="fas fa-money-bill-wave fa-2x mb-2"></i>
                                <span>Comptabilité</span>
                            </a>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <a href="{{ url_for('doctor.medications') }}" class="btn btn-outline-info w-100 h-100 d-flex flex-column justify-content-center">
                                <i class="fas fa-pills fa-2x mb-2"></i>
                                <span>Médicaments</span>
                            </a>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <a href="{{ url_for('doctor.predefined_prescriptions') }}" class="btn btn-outline-warning w-100 h-100 d-flex flex-column justify-content-center">
                                <i class="fas fa-prescription-bottle fa-2x mb-2"></i>
                                <span>Ordonnances prédéfinies</span>
                            </a>
                        </div>
                        <!-- Nouveau patient -->
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <a href="{{ url_for('doctor.new_patient_doctor') }}" class="btn btn-outline-success w-100 h-100 d-flex flex-column justify-content-center">
                                <i class="fas fa-user-plus fa-2x mb-2"></i>
                                <span>Nouveau patient</span>
                            </a>
                        </div>
                        <!-- RDV en ligne (أونلاين) -->
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <a href="{{ url_for('doctor.online_appointments_doctor') }}" class="btn btn-outline-primary w-100 h-100 d-flex flex-column justify-content-center">
                                <i class="fas fa-globe fa-2x mb-2"></i>
                                <span>Rendez-vous en ligne</span>
                            </a>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <a href="{{ url_for('doctor.doctor_calendar') }}" class="btn btn-outline-secondary w-100 h-100 d-flex flex-column justify-content-center">
                                <i class="fas fa-calendar fa-2x mb-2"></i>
                                <span>Calendrier</span>
                            </a>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <a href="{{ url_for('doctor.doctor_settings') }}" class="btn btn-outline-dark w-100 h-100 d-flex flex-column justify-content-center">
                                <i class="fas fa-cog fa-2x mb-2"></i>
                                <span>Paramètres</span>
                            </a>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <a href="{{ url_for('doctor.waiting_queue_status') }}" class="btn btn-outline-primary w-100 h-100 d-flex flex-column justify-content-center">
                                <i class="fas fa-list-ul fa-2x mb-2"></i>
                                <span>File d'attente</span>
                            </a>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <a href="{{ url_for('doctor.create_test_emergency_ticket') }}" class="btn btn-outline-danger w-100 h-100 d-flex flex-column justify-content-center" title="Créer des tickets de test">
                                <i class="fas fa-vial fa-2x mb-2"></i>
                                <span>Test Urgence</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.bg-gradient-primary {
    background: linear-gradient(45deg, #007bff, #0056b3);
}
.bg-gradient-success {
    background: linear-gradient(45deg, #28a745, #1e7e34);
}
.bg-gradient-warning {
    background: linear-gradient(45deg, #ffc107, #e0a800);
}
.bg-gradient-info {
    background: linear-gradient(45deg, #17a2b8, #117a8b);
}
.bg-gradient-secondary {
    background: linear-gradient(45deg, #6c757d, #495057);
}
.avatar-circle {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: bold;
}
.card {
    transition: transform 0.2s;
}
.card:hover {
    transform: translateY(-2px);
}
</style>
{% endblock content %}

{% block scripts %}
<script>
// تحديث التاريخ والوقت الحالي
function updateDateTime() {
    const now = new Date();
    
    // عرض التاريخ بالفرنسية
    const dateString = now.toLocaleDateString('fr-FR', {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
    document.getElementById('current-date').textContent = dateString;
    
    // عرض الوقت
    const timeString = now.toLocaleTimeString('fr-FR', {
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
    });
    document.getElementById('current-time').textContent = timeString;
}

// تحديث التاريخ والوقت كل ثانية
setInterval(updateDateTime, 1000);
updateDateTime();

// تحديث الصفحة كل 30 ثانية للحصول على آخر التحديثات
setInterval(function() {
    location.reload();
}, 30000);

// إضافة تأثيرات تفاعلية
document.addEventListener('DOMContentLoaded', function() {
    // تأثير hover للبطاقات
    const cards = document.querySelectorAll('.card');
    cards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.boxShadow = '0 8px 25px rgba(0,0,0,0.15)';
        });
        card.addEventListener('mouseleave', function() {
            this.style.boxShadow = '';
        });
    });
});
</script>

<style>
/* Styles pour les tickets prioritaires */
.priority-item-highlight {
    background: linear-gradient(90deg, rgba(255, 193, 7, 0.1) 0%, rgba(255, 255, 255, 1) 100%);
    border-left: 4px solid #ffc107 !important;
    animation: priority-glow 2s ease-in-out infinite alternate;
}

/* Styles pour les tickets critiques dans le dashboard */
.critical-item-highlight {
    background: linear-gradient(90deg, rgba(220, 53, 69, 0.15) 0%, rgba(255, 255, 255, 1) 100%);
    border-left: 5px solid #dc3545 !important;
    animation: critical-glow-dashboard 1.5s ease-in-out infinite alternate;
    position: relative;
}

.critical-item-highlight::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, rgba(220, 53, 69, 0.08) 0%, transparent 60%);
    pointer-events: none;
}

.priority-badge-pulse {
    animation: pulse-warning 1.5s ease-in-out infinite;
    box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
}

@keyframes priority-glow {
    0% {
        box-shadow: 0 0 5px rgba(255, 193, 7, 0.3);
    }
    100% {
        box-shadow: 0 0 15px rgba(255, 193, 7, 0.6);
    }
}

@keyframes pulse-warning {
    0% {
        transform: scale(1);
        box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
    }
    50% {
        transform: scale(1.05);
        box-shadow: 0 0 20px rgba(255, 193, 7, 0.8);
    }
    100% {
        transform: scale(1);
        box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
    }
}

/* Badge urgent avec animation */
.badge.bg-warning.text-dark.px-2.py-1.small {
    animation: urgent-blink 1s ease-in-out infinite alternate;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

@keyframes urgent-blink {
    0% {
        opacity: 0.8;
    }
    100% {
        opacity: 1;
        transform: scale(1.05);
    }
}

/* Amélioration de l'affichage des étoiles */
.fa-star.text-warning.fa-lg {
    filter: drop-shadow(0 0 3px rgba(255, 193, 7, 0.7));
    animation: star-twinkle 2s ease-in-out infinite;
}

@keyframes star-twinkle {
    0%, 100% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.8;
        transform: scale(1.1);
    }
}

/* Styles pour les indicateurs d'urgence */
.emergency-indicators {
    animation: emergency-attention 2s ease-in-out infinite;
}

.emergency-icon {
    animation: emergency-shake 1.5s ease-in-out infinite;
    filter: drop-shadow(0 0 5px rgba(220, 53, 69, 0.7));
}

.emergency-badge-small {
    animation: emergency-pulse-small 1.5s ease-in-out infinite;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.emergency-badge-inline {
    animation: emergency-blink 2s ease-in-out infinite;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

.star-twinkle {
    animation: star-twinkle-dashboard 2s ease-in-out infinite;
    filter: drop-shadow(0 0 3px rgba(255, 193, 7, 0.8));
}

/* Animations pour les urgences */
@keyframes emergency-attention {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.05);
    }
}

@keyframes emergency-shake {
    0%, 100% {
        transform: translateX(0);
    }
    25% {
        transform: translateX(-2px);
    }
    75% {
        transform: translateX(2px);
    }
}

@keyframes emergency-pulse-small {
    0% {
        transform: scale(1);
        opacity: 1;
    }
    50% {
        transform: scale(1.1);
        opacity: 0.8;
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

@keyframes emergency-blink {
    0%, 50% {
        opacity: 1;
    }
    25% {
        opacity: 0.7;
    }
    75% {
        opacity: 0.9;
    }
}

@keyframes star-twinkle-dashboard {
    0%, 100% {
        opacity: 1;
        transform: scale(1) rotate(0deg);
    }
    50% {
        opacity: 0.7;
        transform: scale(1.2) rotate(180deg);
    }
}

/* Styles pour les tickets critiques (priority = 2) */
.critical-item-highlight {
    background: linear-gradient(90deg, rgba(220, 53, 69, 0.15) 0%, rgba(255, 255, 255, 1) 100%);
    border-left: 5px solid #dc3545 !important;
    animation: critical-glow 1.5s ease-in-out infinite alternate;
    position: relative;
}

.critical-item-highlight::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, rgba(220, 53, 69, 0.1) 0%, transparent 50%);
    pointer-events: none;
}

.critical-badge-pulse {
    animation: critical-pulse 1s ease-in-out infinite;
    box-shadow: 0 0 15px rgba(220, 53, 69, 0.7);
}

.critical-badge-inline {
    animation: critical-flash 1.5s ease-in-out infinite;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.critical-indicators {
    animation: critical-attention 1.5s ease-in-out infinite;
}

.critical-icon {
    animation: critical-shake 1s ease-in-out infinite;
    filter: drop-shadow(0 0 8px rgba(220, 53, 69, 0.8));
}

.critical-badge-small {
    animation: critical-pulse-small 1s ease-in-out infinite;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.critical-pulse-dot {
    width: 8px;
    height: 8px;
    background: #dc3545;
    border-radius: 50%;
    animation: critical-dot-pulse 1s ease-in-out infinite;
}

/* Amélioration des styles pour les tickets prioritaires (priority = 1) */
.emergency-item-dashboard {
    background: linear-gradient(90deg, rgba(255, 193, 7, 0.1) 0%, rgba(255, 255, 255, 1) 100%);
    border-left: 4px solid #ffc107 !important;
    animation: priority-glow-dashboard 2s ease-in-out infinite alternate;
}

.priority-indicators {
    animation: priority-attention 2s ease-in-out infinite;
}

.priority-icon {
    animation: priority-twinkle 2s ease-in-out infinite;
    filter: drop-shadow(0 0 5px rgba(255, 193, 7, 0.8));
}

.priority-badge-small {
    animation: priority-pulse-small 2s ease-in-out infinite;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

.urgent-badge-inline {
    animation: urgent-flash-dashboard 2s ease-in-out infinite;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

/* Animations pour les tickets critiques */
@keyframes critical-glow {
    0% {
        box-shadow: 0 0 15px rgba(220, 53, 69, 0.3);
    }
    100% {
        box-shadow: 0 0 25px rgba(220, 53, 69, 0.6);
    }
}

@keyframes critical-pulse {
    0% {
        transform: scale(1);
        box-shadow: 0 0 15px rgba(220, 53, 69, 0.7);
    }
    50% {
        transform: scale(1.1);
        box-shadow: 0 0 25px rgba(220, 53, 69, 1);
    }
    100% {
        transform: scale(1);
        box-shadow: 0 0 15px rgba(220, 53, 69, 0.7);
    }
}

@keyframes critical-flash {
    0%, 50% {
        opacity: 1;
        transform: scale(1);
    }
    25% {
        opacity: 0.7;
        transform: scale(1.1);
    }
    75% {
        opacity: 0.9;
        transform: scale(0.95);
    }
}

@keyframes critical-attention {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.1);
    }
}

@keyframes critical-shake {
    0%, 100% {
        transform: translateX(0) rotate(0deg);
    }
    25% {
        transform: translateX(-3px) rotate(-5deg);
    }
    75% {
        transform: translateX(3px) rotate(5deg);
    }
}

@keyframes critical-pulse-small {
    0% {
        transform: scale(1);
        opacity: 1;
    }
    50% {
        transform: scale(1.2);
        opacity: 0.7;
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

@keyframes critical-dot-pulse {
    0% {
        transform: scale(1);
        opacity: 1;
    }
    50% {
        transform: scale(1.5);
        opacity: 0.5;
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Animations améliorées pour les tickets prioritaires */
@keyframes priority-glow-dashboard {
    0% {
        box-shadow: 0 0 10px rgba(255, 193, 7, 0.3);
    }
    100% {
        box-shadow: 0 0 20px rgba(255, 193, 7, 0.5);
    }
}

@keyframes priority-attention {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.05);
    }
}

@keyframes priority-twinkle {
    0%, 100% {
        opacity: 1;
        transform: scale(1) rotate(0deg);
    }
    50% {
        opacity: 0.8;
        transform: scale(1.2) rotate(180deg);
    }
}

@keyframes priority-pulse-small {
    0% {
        transform: scale(1);
        opacity: 1;
    }
    50% {
        transform: scale(1.1);
        opacity: 0.8;
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

@keyframes urgent-flash-dashboard {
    0%, 50% {
        opacity: 1;
    }
    25% {
        opacity: 0.8;
        transform: scale(1.05);
    }
    75% {
        opacity: 0.9;
        transform: scale(0.98);
    }
}

/* Responsive pour mobile */
@media (max-width: 768px) {
    .priority-item-highlight, .critical-item-highlight {
        border-left: 3px solid #ffc107 !important;
    }
    
    .critical-item-highlight {
        border-left: 3px solid #dc3545 !important;
    }
    
    .badge.bg-warning.text-dark.px-2.py-1.small,
    .badge.bg-danger.text-white.px-2.py-1.small {
        font-size: 0.7rem;
    }
    
    .priority-indicators, .critical-indicators {
        flex-direction: row;
        gap: 0.5rem;
    }
    
    .priority-badge-small, .critical-badge-small {
        font-size: 0.6rem;
    }
}
</style>
{% endblock %}
