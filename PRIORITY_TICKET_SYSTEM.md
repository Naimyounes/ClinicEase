# ูุธุงู ุงูุชุฐุงูุฑ ูุน ุงูุฃููููุฉ - ClinicEase

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ุชุฐุงูุฑ ูุชูุฏู ูุฏุนู ุงูุฃููููุฉ ูููุฑุถู ุงูุฐูู ูุฏููู ููุงุนูุฏ ูุฌุฏููุฉ. ุงููุธุงู ูุนุทู ุฃููููุฉ ูููุฑุถู ุงูุฐูู ูุญุถุฑูู ูู ููุช ููุนุฏูู ุฃู ุจุนุฏูุ ูุน ุชูููุฒ ุฎุงุต ุจุฑูู ุงูุชุฐูุฑุฉ + ุญุฑู R.

## ๐ฏ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. ูุธุงู ุงูุชุฐุงูุฑ ุงููุฒุฏูุฌ
- **ุชุฐุงูุฑ ุนุงุฏูุฉ**: ูููุฑุถู ุจุฏูู ููุงุนูุฏ (ุฑูู ููุท: 1, 2, 3...)
- **ุชุฐุงูุฑ ุฃููููุฉ**: ูููุฑุถู ูุน ููุงุนูุฏ (ุฑูู + R: 1R, 2R, 3R...)

### 2. ุญุณุงุจ ุงูุฃููููุฉ ุงูุชููุงุฆู
- ูุชู ูุญุต ูุฌูุฏ ููุนุฏ ูููุฑูุถ ูู ููุณ ุงูููู
- ุฅุฐุง ูุงู ุงูููุช ุงูุญุงูู >= ููุช ุงูููุนุฏ โ ุฃููููุฉ ุชููุงุฆูุฉ
- ุงูุชุฐูุฑุฉ ุชุญุตู ุนูู ุญุฑู R ููุนุงููุฉ ุฎุงุตุฉ

### 3. ุญุณุงุจ ูุฏุฉ ุงูุงูุชุธุงุฑ ุงูุฐูู
- **ุงูุชุฐุงูุฑ ุงูุนุงุฏูุฉ**: ูู ููุช ุฅูุดุงุก ุงูุชุฐูุฑุฉ
- **ุชุฐุงูุฑ ุงูุฃููููุฉ**: ูู ููุช ุงูููุนุฏ ุงููุฌุฏูู (ููุณ ูู ููุช ุฅูุดุงุก ุงูุชุฐูุฑุฉ)

### 4. ุชุฑุชูุจ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
- ุงูุฃููููุฉ ุฃููุงู (ุชุฐุงูุฑ R ูุจู ุงูุชุฐุงูุฑ ุงูุนุงุฏูุฉ)
- ุซู ุงูุชุฑุชูุจ ุญุณุจ ุงูุฑูู ุชุตุงุนุฏูุงู

## ๐ง ุงูุชุทุจูู ุงูุชููู

### ุชุญุฏูุซุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### ูููุฐุฌ Ticket ุงููุญุฏุซ:
```python
class Ticket(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    patient_id = db.Column(db.Integer, db.ForeignKey("patient.id"), nullable=False)
    number = db.Column(db.Integer, nullable=False)
    status = db.Column(db.String(20), nullable=False, default="waiting")
    created_at = db.Column(db.DateTime, nullable=False, default=datetime.utcnow)
    
    # ุญููู ูุธุงู ุงูุฃููููุฉ ุงูุฌุฏูุฏุฉ
    ticket_type = db.Column(db.String(20), nullable=False, default="regular")  # regular, reservation
    appointment_id = db.Column(db.Integer, db.ForeignKey("appointment.id"), nullable=True)
    priority = db.Column(db.Integer, nullable=False, default=0)  # 0 = ุนุงุฏูุ 1 = ุฃููููุฉ
    
    @property
    def display_number(self):
        return f"{self.number}R" if self.ticket_type == "reservation" else str(self.number)
```

### ููุทู ุฅูุดุงุก ุงูุชุฐูุฑุฉ

```python
def create_waiting_ticket(patient_id):
    # ุงูุชุญูู ูู ูุฌูุฏ ููุนุฏ ุงูููู
    today_appointment = Appointment.query.filter(
        Appointment.patient_id == patient_id,
        db.func.date(Appointment.appointment_date) == today,
        Appointment.status == "ูุฌุฏูู"
    ).first()
    
    # ุชุญุฏูุฏ ููุน ุงูุชุฐูุฑุฉ
    ticket_type = "regular"
    priority = 0
    
    if today_appointment:
        appointment_time = today_appointment.appointment_date.time()
        current_time = datetime.now().time()
        
        # ุฅุฐุง ุญุถุฑ ูู ููุช ุงูููุนุฏ ุฃู ุจุนุฏู
        if current_time >= appointment_time:
            ticket_type = "reservation"
            priority = 1
            appointment_id = today_appointment.id
```

### ุชุฑุชูุจ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ

```python
waiting_tickets = Ticket.query.filter(
    db.func.date(Ticket.created_at) == today,
    Ticket.status == "waiting"
).order_by(
    Ticket.priority.desc(),  # ุงูุฃููููุฉ ุฃููุงู
    Ticket.number.asc()      # ุซู ุงูุฑูู ุชุตุงุนุฏูุงู
).all()
```

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ูุคุดุฑุงุช ุจุตุฑูุฉ ููุฃููููุฉ

#### ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ:
- **ุชุฐุงูุฑ ุงูุฃููููุฉ**: ุฎูููุฉ ุตูุฑุงุก ูุงุชุญุฉ
- **ุฑูู ุงูุชุฐูุฑุฉ**: badge ุฃุตูุฑ ููุฃููููุฉุ ุฃุฒุฑู ููุนุงุฏู
- **ุฃููููุฉ ูุฌูุฉ**: ุจุฌุงูุจ ุงุณู ุงููุฑูุถ ููุฃููููุฉ
- **ููุน ุงูุชุฐูุฑุฉ**: ุนููุฏ ูููุตู ููุถุญ "ุฃููููุฉ" ุฃู "ุนุงุฏู"

#### ูู ููุญุฉ ุงูุชุญูู:
- **ุฅุญุตุงุฆูุงุช ูุญุฏุซุฉ**: ุนุฏุฏ ุงูุชุฐุงูุฑ ูุน ุนุฏุฏ ุงูุฃููููุฉ
- **ุงููุฑูุถ ุงูุญุงูู**: ุนุฑุถ ุฑูู ุงูุชุฐูุฑุฉ ูุน R ุฅุฐุง ูุงูุช ุฃููููุฉ
- **ุจุทุงูุฉ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ**: ุฑุงุจุท ุณุฑูุน ูุน ุนุฏุงุฏ

### ุญุณุงุจ ูุฏุฉ ุงูุงูุชุธุงุฑ ุงููุญุณู

```html
{% if ticket.ticket_type == 'reservation' and ticket.appointment %}
    {% set appointment_time = ticket.appointment.appointment_date %}
    {% set current_time = get_current_datetime() %}
    {% if current_time >= appointment_time %}
        {% set waiting_time = (current_time - appointment_time).total_seconds() / 60 %}
    {% else %}
        {% set waiting_time = 0 %}
    {% endif %}
    <small class="text-muted">ููุฐ ููุช ุงูููุนุฏ</small>
{% else %}
    {% set waiting_time = (get_current_datetime() - ticket.created_at).total_seconds() / 60 %}
{% endif %}
```

## ๐ ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู

### ุงูุณููุงุฑูู 1: ูุฑูุถ ุจุฏูู ููุนุฏ
1. ุงููุฑูุถ ูุตู ููุนูุงุฏุฉ
2. ุงูุณูุฑุชูุฑุฉ ุชูุดุฆ ุชุฐูุฑุฉ ุนุงุฏูุฉ
3. ูุญุตู ุนูู ุฑูู ุชุณูุณูู (ูุซู: 5)
4. ูุฏุฉ ุงูุงูุชุธุงุฑ ุชุญุณุจ ูู ููุช ุฅูุดุงุก ุงูุชุฐูุฑุฉ

### ุงูุณููุงุฑูู 2: ูุฑูุถ ูุน ููุนุฏ - ูุตู ูุจูุฑุงู
1. ุงููุฑูุถ ูุฏูู ููุนุฏ ุงูุณุงุนุฉ 3:00 PM
2. ูุตู ุงูุณุงุนุฉ 2:30 PM
3. ููุดุฆ ุชุฐูุฑุฉ ุนุงุฏูุฉ (6) ูุฃู ุงูููุช ูู ูุญู ุจุนุฏ
4. ูุฏุฉ ุงูุงูุชุธุงุฑ ูู ููุช ุฅูุดุงุก ุงูุชุฐูุฑุฉ

### ุงูุณููุงุฑูู 3: ูุฑูุถ ูุน ููุนุฏ - ูุตู ูู ุงูููุช ุฃู ูุชุฃุฎุฑุงู
1. ุงููุฑูุถ ูุฏูู ููุนุฏ ุงูุณุงุนุฉ 3:00 PM
2. ูุตู ุงูุณุงุนุฉ 3:15 PM
3. ููุดุฆ ุชุฐูุฑุฉ ุฃููููุฉ (7R)
4. ูุญุตู ุนูู ุฃููููุฉ ูู ุงููุงุฆูุฉ
5. ูุฏุฉ ุงูุงูุชุธุงุฑ ุชุญุณุจ ูู ููุช ุงูููุนุฏ (3:00 PM)

## ๐ ุชุฏูู ุงูุนูู

### ุฅูุดุงุก ุงูุชุฐูุฑุฉ:
1. **ุงุฎุชูุงุฑ ุงููุฑูุถ** ูู ูุงุฆูุฉ ุงููุฑุถู
2. **ูุญุต ุชููุงุฆู** ููุฌูุฏ ููุนุฏ ุงูููู
3. **ุชุญุฏูุฏ ููุน ุงูุชุฐูุฑุฉ** ุญุณุจ ุงูููุช
4. **ุฅูุดุงุก ุงูุชุฐูุฑุฉ** ูุน ุงูุฃููููุฉ ุงูููุงุณุจุฉ
5. **ุฅุถุงูุฉ ูููุงุฆูุฉ** ูุน ุงูุชุฑุชูุจ ุงูุตุญูุญ

### ุงุณุชุฏุนุงุก ุงููุฑุถู:
1. **ุนุฑุถ ุงููุงุฆูุฉ** ูุฑุชุจุฉ ุญุณุจ ุงูุฃููููุฉ
2. **ุงุณุชุฏุนุงุก ุงูุชุงูู** (ุฃููููุฉ ุฃููุงู)
3. **ุชุญุฏูุซ ุงูุญุงูุฉ** ููุชุฐูุฑุฉ ุงููุณุชุฏุนุงุฉ
4. **ุฅุดุนุงุฑ ุจุตุฑู** ุจุฑูู ุงูุชุฐูุฑุฉ ูููุนูุง

## ๐ ุงูููุงุฆุฏ

### ูููุฑุถู:
- **ุงุญุชุฑุงู ุงูููุงุนูุฏ**: ูู ูุฏูู ููุนุฏ ูุง ููุชุธุฑ ุทูููุงู
- **ุดูุงููุฉ**: ุฑูู ุงูุชุฐูุฑุฉ ููุถุญ ููุน ุงูุฃููููุฉ
- **ุนุฏุงูุฉ**: ูุธุงู ูุงุถุญ ูููููู ููุฌููุน

### ููุนูุงุฏุฉ:
- **ุชูุธูู ุฃูุถู**: ุฅุฏุงุฑุฉ ูุนุงูุฉ ููุงุฆูุฉ ุงูุงูุชุธุงุฑ
- **ุฑุถุง ุงููุฑุถู**: ุชูููู ุดูุงูู ุงูุงูุชุธุงุฑ
- **ููุงุกุฉ**: ุงุณุชุบูุงู ุฃูุซู ูููุช ุงูุทุจูุจ

### ููุณูุฑุชูุฑุฉ:
- **ุณูููุฉ ุงูุฅุฏุงุฑุฉ**: ูุงุฌูุฉ ูุงุถุญุฉ ููุจุงุดุฑุฉ
- **ูุนูููุงุช ุดุงููุฉ**: ุฅุญุตุงุฆูุงุช ูุชูุงุตูู ูุงููุฉ
- **ูุฑููุฉ**: ุฅููุงููุฉ ุงูุชุญูู ูู ุงููุงุฆูุฉ

## ๐ฏ ุงูููุฒุงุช ุงููุณุชูุจููุฉ

### ุชุญุณููุงุช ููุชุฑุญุฉ:
1. **ุฅุดุนุงุฑุงุช SMS**: ุชูุจูู ุงููุฑุถู ูุจู ููุนุฏูู
2. **ุญุฌุฒ ุฃูููุงูู**: ุชุฐุงูุฑ ุฃููููุฉ ูู ุงููููุน
3. **ุชูุงุฑูุฑ ุชูุตูููุฉ**: ุฅุญุตุงุฆูุงุช ุงูุงูุชุธุงุฑ ูุงูุฃููููุฉ
4. **ุชูุงูู ูุน ุงูุชูููู**: ุฑุจุท ุฃุนูู ูุน ูุธุงู ุงูููุงุนูุฏ

## ๐ง ุงูุตูุงูุฉ ูุงูุฏุนู

### ูููุงุช ูููุฉ:
- `clinic_app/models.py`: ููุงุฐุฌ ูุงุนุฏุฉ ุงูุจูุงูุงุช
- `clinic_app/secretary/routes.py`: ููุทู ุฅูุดุงุก ุงูุชุฐุงูุฑ
- `clinic_app/templates/secretary/waiting_queue.html`: ูุงุฌูุฉ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
- `update_ticket_model.py`: ุณูุฑูุจุช ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ูุตุงุฆุญ ุงูุตูุงูุฉ:
1. **ูุณุฎ ุงุญุชูุงุทูุฉ ููุชุธูุฉ** ููุงุนุฏุฉ ุงูุจูุงูุงุช
2. **ูุฑุงูุจุฉ ุงูุฃุฏุงุก** ุฎุงุตุฉ ูุน ุฒูุงุฏุฉ ุนุฏุฏ ุงูุชุฐุงูุฑ
3. **ุชุญุฏูุซ ุฏูุฑู** ูููุงุฌูุงุช ูุงูููุฒุงุช
4. **ุชุฏุฑูุจ ุงููุณุชุฎุฏููู** ุนูู ุงููุธุงู ุงูุฌุฏูุฏ

---

**ุชุงุฑูุฎ ุงูุชุทููุฑ**: 30 ููููู 2025  
**ุงูุฅุตุฏุงุฑ**: 2.0  
**ุงููุทูุฑ**: ูุฑูู ClinicEase  
**ุงูุญุงูุฉ**: ููุชูู ููุฎุชุจุฑ โ