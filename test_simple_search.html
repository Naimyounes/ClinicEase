<!DOCTYPE html>
<html>
<head>
    <title>اختبار البحث البسيط</title>
    <style>
        .search-container {
            position: relative;
            width: 300px;
            margin: 50px;
        }
        
        .search-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        .dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .dropdown-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }
        
        .dropdown-item:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <h1>اختبار البحث في الأدوية</h1>
    
    <div class="search-container">
        <input type="text" class="search-input" placeholder="ابحث عن دواء..." id="searchInput">
        <div class="dropdown" id="dropdown"></div>
    </div>
    
    <div id="result"></div>

    <script>
        // بيانات تجريبية للأدوية
        const medications = [
            { id: 1, name: "PARACETAMOL", dosage: "500MG" },
            { id: 2, name: "AMOXICILLIN", dosage: "250MG" },
            { id: 3, name: "IBUPROFEN", dosage: "400MG" },
            { id: 4, name: "CETIRIZINE", dosage: "10MG" },
            { id: 5, name: "PARACETAMOL", dosage: "1000MG" }
        ];
        
        const searchInput = document.getElementById('searchInput');
        const dropdown = document.getElementById('dropdown');
        const result = document.getElementById('result');
        
        console.log('Script loaded, medications:', medications.length);
        
        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase().trim();
            console.log('Search term:', searchTerm);
            
            if (searchTerm.length < 2) {
                dropdown.style.display = 'none';
                return;
            }
            
            const filteredMeds = medications.filter(med => 
                med.name.toLowerCase().includes(searchTerm) || 
                (med.dosage && med.dosage.toLowerCase().includes(searchTerm))
            );
            
            console.log('Filtered medications:', filteredMeds.length);
            
            if (filteredMeds.length > 0) {
                let html = '';
                filteredMeds.forEach(med => {
                    const displayName = med.dosage ? `${med.name} (${med.dosage})` : med.name;
                    html += `<div class="dropdown-item" data-id="${med.id}">${displayName}</div>`;
                });
                
                dropdown.innerHTML = html;
                dropdown.style.display = 'block';
                
                // إضافة مستمعي النقر
                dropdown.querySelectorAll('.dropdown-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const medId = this.getAttribute('data-id');
                        const medName = this.textContent;
                        
                        searchInput.value = medName;
                        dropdown.style.display = 'none';
                        result.innerHTML = `تم اختيار: ${medName} (ID: ${medId})`;
                        
                        console.log('Selected medication:', medId, medName);
                    });
                });
            } else {
                dropdown.innerHTML = '<div class="dropdown-item">لا توجد نتائج</div>';
                dropdown.style.display = 'block';
            }
        });
        
        // إخفاء القائمة عند النقر خارجها
        document.addEventListener('click', function(e) {
            if (!searchInput.contains(e.target) && !dropdown.contains(e.target)) {
                dropdown.style.display = 'none';
            }
        });
        
        console.log('Event listeners attached');
    </script>
</body>
</html>