# ميزة المواعيد الطبية - ClinicEase

## نظرة عامة
تم إضافة نظام إدارة المواعيد الطبية إلى ClinicEase لتمكين الأطباء من جدولة مواعيد المتابعة للمرضى الذين لديهم زيارات معلقة.

## الميزات الجديدة

### 1. إدارة المواعيد
- **إنشاء مواعيد**: يمكن للطبيب إنشاء موعد متابعة عندما تكون حالة الزيارة "معلقة"
- **عرض المواعيد**: قائمة شاملة بجميع المواعيد مع إمكانية الفلترة حسب الحالة
- **تحديث حالة الموعد**: تحديث حالة الموعد (مجدول، مكتمل، ملغي، فائت)
- **حذف المواعيد**: إمكانية حذف المواعيد غير المكتملة

### 2. حالات الزيارة الجديدة
تم إضافة حالة جديدة للزيارات:
- **معلقة**: للزيارات التي تحتاج متابعة وموعد قادم

### 3. واجهة المستخدم
- **لوحة تحكم محدثة**: إحصائيات المواعيد اليومية والقادمة
- **قائمة تنقل محدثة**: رابط مباشر لصفحة المواعيد
- **أزرار سريعة**: زر "حجز موعد متابعة" في صفحة عرض الزيارة المعلقة

## كيفية الاستخدام

### إنشاء موعد جديد
1. قم بإجراء زيارة طبية للمريض
2. اختر حالة "معلقة" عند حفظ الزيارة
3. في صفحة عرض الزيارة، انقر على "حجز موعد متابعة"
4. اختر تاريخ ووقت الموعد
5. أضف ملاحظات (اختياري)
6. احفظ الموعد

### إدارة المواعيد
1. انتقل إلى صفحة "المواعيد" من القائمة الرئيسية
2. استخدم الفلتر لعرض مواعيد بحالة معينة
3. انقر على "عرض" لمشاهدة تفاصيل الموعد
4. استخدم الأزرار لتحديث حالة الموعد

## قاعدة البيانات

### جدول المواعيد الجديد
```sql
CREATE TABLE appointment (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    patient_id INTEGER NOT NULL,
    doctor_id INTEGER NOT NULL,
    visit_id INTEGER,
    appointment_date DATETIME NOT NULL,
    status VARCHAR(20) NOT NULL DEFAULT 'مجدول',
    notes TEXT,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (patient_id) REFERENCES patient (id),
    FOREIGN KEY (doctor_id) REFERENCES user (id),
    FOREIGN KEY (visit_id) REFERENCES visit (id)
);
```

### حالات الموعد
- **مجدول**: الموعد مجدول ولم يحن وقته بعد
- **مكتمل**: تم إجراء الموعد بنجاح
- **ملغي**: تم إلغاء الموعد
- **فائت**: لم يحضر المريض للموعد

## الملفات المضافة/المحدثة

### ملفات جديدة
- `clinic_app/templates/doctor/appointments.html` - صفحة قائمة المواعيد
- `clinic_app/templates/doctor/create_appointment.html` - صفحة إنشاء موعد
- `clinic_app/templates/doctor/view_appointment.html` - صفحة عرض تفاصيل الموعد

### ملفات محدثة
- `clinic_app/models.py` - إضافة نموذج Appointment
- `clinic_app/doctor/forms.py` - إضافة AppointmentForm
- `clinic_app/doctor/routes.py` - إضافة routes المواعيد
- `clinic_app/templates/doctor/dashboard.html` - إضافة إحصائيات المواعيد
- `clinic_app/templates/doctor/view_visit.html` - إضافة زر حجز الموعد
- `clinic_app/templates/layout.html` - إضافة رابط المواعيد للقائمة

## الإحصائيات
تعرض لوحة التحكم الآن:
- عدد مواعيد اليوم
- عدد المواعيد القادمة المجدولة

## ملاحظات تقنية
- تم استخدام `DateTimeLocalField` لاختيار التاريخ والوقت
- تم إضافة التحقق من صحة البيانات لمنع إنشاء مواعيد متكررة
- تم ربط المواعيد بالزيارات المعلقة فقط
- تم إضافة حماية للتأكد من أن الطبيب يمكنه الوصول لمواعيده فقط

## التحديثات المستقبلية المقترحة
- إشعارات للمواعيد القادمة
- تقويم شهري لعرض المواعيد
- إمكانية تعديل موعد موجود
- تذكيرات SMS للمرضى
- تصدير قائمة المواعيد إلى PDF